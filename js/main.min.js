$(document).ready(function(){$.fn.scrollStopped=function(a){var b=$(this),c=this;b.scroll(function(){b.data("scrollTimeout")&&clearTimeout(b.data("scrollTimeout")),b.data("scrollTimeout",setTimeout(a,250,c))})},_now=Date.now||function(){return(new Date).getTime()},_throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:_now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=_now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,k<=0||k>b?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}};var a=["-webkit-","-moz-","-ms-","-o-",""],b=function(b,c){$.each(a,function(a,d){b.css(d+"transform","scale3d("+c+", "+c+", 1)")})},d=function(b,c){$.each(a,function(a,d){b.css(d+"transform","translate3d(0, "+c+", 0)")})},e=function(b,c,d){$.each(a,function(a,e){b.css(e+"transform","translateX("+c+") scale3d("+d+", "+d+", 1)")})},f=function(a){history.pushState?history.pushState(null,null,a):location.hash=a},g=function(a){$("#menu-items li").removeClass("pure-menu-selected"),$(a).addClass("pure-menu-selected")},h=$("#image-grid"),i=$(".all-categories");$("#menu-items li").click(function(){var a=$(this);g(a);var b=a.attr("id"),c="#"+b.substr("menu-item-".length,b.length);f(c),"menu-item-portfolio"===b&&($(".filter-options .active").removeClass("active"),i.addClass("active"),h.shuffle("shuffle","all"))});var j=window.location.hash;""!==j&&(j=j.substr(1,j.length),g($("#menu-item-"+j)));var k=$("nav");k.localScroll({duration:600});var l=$(window),m=!1,n=window.AnimationFrame;n.shim();var o,p=$(document).height(),q=$("#about-me"),r=$("#sticky-header"),s=$("#doodle"),t=$("#doodle-image"),u=s.height(),v=$("#cloud-left"),w=$("#cloud-right"),B=$(window).height(),C=p-B,D=function(a){if(m){var b=1+(a-u)/u;if(b=+b.toFixed(4),E(b),r.length>0&&q.length>0){var c=k.height()+r.height(),d=q.offset().top,e=h.offset().top;a+c>d?(r.hasClass("no-transition")&&r.removeClass("no-transition"),r.hasClass("hidden")||r.addClass("hidden")):(r.hasClass("hidden")&&r.removeClass("hidden"),a+c<e&&(r.hasClass("no-transition")||r.addClass("no-transition")),F(b))}L(a),n(function(){D(a)}),m=!1}},E=function(a){if(!(a>1)){var c=1-a;c=c<0?0:c,b(t,c),e(v,100*-a+"%",c),e(w,100*a+"%",c)}},F=function(a){if(a<0)return void r.hide();r.show();var b=100*a;b=b>100?100:b,b>0?k.removeClass("nav-shadow"):k.addClass("nav-shadow"),d(r,b+"%")},G=$("#contact-speaker"),H=$("#moving-colibri"),I=["icon-colibri","icon-colibri-d","icon-colibri","icon-colibri-h"],J=I.length,K=0,L=function(a){a>=C?G.removeClass("icon-speaker-l").addClass("icon-speaker-s"):G.removeClass("icon-speaker-s").addClass("icon-speaker-l"),H.removeClass("icon-colibri icon-colibri-d icon-colibri-h").addClass(I[K]),K++,K=K>=J?0:K},M=function(){H.removeClass("icon-colibri icon-colibri-d icon-colibri-h").addClass("icon-colibri")},O=($("body"),function(){m=!0,o=l.scrollTop(),D(o)});Modernizr.mq("screen and (min-width:523px)")&&(l.scroll(_throttle(O,60)),O(),l.scrollStopped(function(){M()}));var P=function(){var a=$("#shuffle_sizer");h.shuffle({itemSelector:".image-block",sizer:a})},Q=$(".filter-options"),R=function(){var a=Q.children();a.on("click",function(){var a=$(this),b=a.data("group"),c="all"===b,d=a.hasClass("active"),e="all";c?($(".filter-options .active").removeClass("active"),a.addClass("active")):(e=d?"all":a.data("group"),d?i.addClass("active"):$(".filter-options .active").removeClass("active"),a.toggleClass("active")),h.shuffle("shuffle",e),$(window).scrollTo("#portfolio",{duration:600})}),a=null},S=function(){var a=_throttle(function(){h.shuffle("update")},300);h.find("img").each(function(){var b;this.complete&&void 0!==this.naturalWidth||(b=new Image,$(b).on("load",function(){$(this).off("load"),a()}),b.src=this.src)}),setTimeout(function(){a()},500)},T=function(){P(),R(),S()};T(),$(".thumbnail").unveil(200,function(){var a=$(this);a.load(function(){a.addClass("thumbnail-box-shadow").addClass("gray-filter").attr("width","100%").attr("height","100%"),a.next().css("display","block")})});var U=function(){h.each(function(){$(this).magnificPopup({delegate:".filtered a",type:"image",gallery:{enabled:!0},retina:{ratio:2},preload:[2,2],removalDelay:500,callbacks:{beforeOpen:function(){var a=this;a.st.image.markup=a.st.image.markup.replace("mfp-figure","mfp-figure mfp-with-anim"),a.st.mainClass=a.st.el.attr("data-effect")}}})})};U(),$("#contact").hover(function(){G.removeClass("icon-speaker-l").addClass("icon-speaker-s")},function(){G.removeClass("icon-speaker-s").addClass("icon-speaker-l")})});