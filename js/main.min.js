$(document).ready(function(){$.fn.scrollStopped=function(i){var t=$(this),e=this;t.scroll(function(){t.data("scrollTimeout")&&clearTimeout(t.data("scrollTimeout")),t.data("scrollTimeout",setTimeout(i,250,e))})},_now=Date.now||function(){return(new Date).getTime()},_throttle=function(i,t,e){var a,o,n,s=null,l=0;e||(e={});var r=function(){l=e.leading===!1?0:_now(),s=null,n=i.apply(a,o),s||(a=o=null)};return function(){var c=_now();l||e.leading!==!1||(l=c);var u=t-(c-l);return a=this,o=arguments,0>=u||u>t?(clearTimeout(s),s=null,l=c,n=i.apply(a,o),s||(a=o=null)):s||e.trailing===!1||(s=setTimeout(r,u)),n}};var i=["-webkit-","-moz-","-ms-","-o-",""],t=function(t,e){$.each(i,function(i,a){t.css(a+"transform","scale3d("+e+", "+e+", 1)")})},e=function(t,e){$.each(i,function(i,a){t.css(a+"transform","translate3d(0, "+e+", 0)")})},a=function(t,e,a){$.each(i,function(i,o){t.css(o+"transform","translateX("+e+") scale3d("+a+", "+a+", 1)")})},o=function(i){history.pushState?history.pushState(null,null,i):location.hash=i},n=function(i){$("#menu-items li").removeClass("pure-menu-selected"),$(i).addClass("pure-menu-selected")};FastClick.attach(document.body);var s=$("#image-grid"),l=$(".all-categories");$("#menu-items li").click(function(){var i=$(this);n(i);var t=i.attr("id"),e="#"+t.substr("menu-item-".length,t.length);o(e),"menu-item-portfolio"===t&&($(".filter-options .active").removeClass("active"),l.addClass("active"),s.shuffle("shuffle","all"))});var r=window.location.hash;""!==r&&(r=r.substr(1,r.length),n($("#menu-item-"+r)));var c=$("nav");c.localScroll({duration:600});var u=$(window),d=!1,f=window.AnimationFrame;f.shim();var h,m=$(document).height(),v=$("#about-me"),p=$("#sticky-header"),g=$("#doodle"),C=$("#doodle-image"),b=g.height(),w=$("#cloud-left"),k=$("#cloud-right"),y=$(window).height(),T=m-y,_=function(i){if(d){var t=1+(i-b)/b;if(t=+t.toFixed(4),S(t),p.length>0&&v.length>0){var e=c.height()+p.height(),a=v.offset().top,o=s.offset().top;i+e>a?(p.hasClass("no-transition")&&p.removeClass("no-transition"),p.hasClass("hidden")||p.addClass("hidden")):(p.hasClass("hidden")&&p.removeClass("hidden"),o>i+e&&(p.hasClass("no-transition")||p.addClass("no-transition")),x(t))}I(i),f(function(){_(i)}),d=!1}},S=function(i){if(!(i>1)){var e=1-i;e=0>e?0:e,t(C,e),a(w,100*-i+"%",e),a(k,100*i+"%",e)}},x=function(i){if(0>i)return void p.hide();p.show();var t=100*i;t=t>100?100:t,e(p,t+"%")},z=$("#contact-speaker"),D=$("#moving-colibri"),F=["icon-colibri","icon-colibri-d","icon-colibri","icon-colibri-h"],q=F.length,A=0,I=function(i){i>=T?z.removeClass("icon-speaker-l").addClass("icon-speaker-s"):z.removeClass("icon-speaker-s").addClass("icon-speaker-l"),D.removeClass("icon-colibri icon-colibri-d icon-colibri-h").addClass(F[A]),A++,A=A>=q?0:A},M=function(){D.removeClass("icon-colibri icon-colibri-d icon-colibri-h").addClass("icon-colibri")},O=($("body"),function(){d=!0,h=u.scrollTop(),_(h)});Modernizr.mq("screen and (min-width:523px)")&&(u.scroll(_throttle(O,60)),O(),u.scrollStopped(function(){M()}));var P=function(){var i=$("#shuffle_sizer");s.shuffle({itemSelector:".image-block",sizer:i})},W=$(".filter-options"),X=function(){var i=W.children();i.on("click",function(){var i=$(this),t=i.data("group"),e="all"===t,a=i.hasClass("active"),o="all";e?($(".filter-options .active").removeClass("active"),i.addClass("active")):(o=a?"all":i.data("group"),a?l.addClass("active"):$(".filter-options .active").removeClass("active"),i.toggleClass("active")),s.shuffle("shuffle",o),$(window).scrollTo("#portfolio",{duration:600})}),i=null},j=function(){var i=_throttle(function(){s.shuffle("update")},300);s.find("img").each(function(){var t;this.complete&&void 0!==this.naturalWidth||(t=new Image,$(t).on("load",function(){$(this).off("load"),i()}),t.src=this.src)}),setTimeout(function(){i()},500)},B=function(){P(),X(),j()};B(),$(".thumbnail").unveil(200,function(){var i=$(this);i.load(function(){i.addClass("thumbnail-box-shadow").addClass("gray-filter").attr("width","100%").attr("height","100%"),i.next().css("display","block")})});var E=function(){s.each(function(){$(this).magnificPopup({delegate:".filtered a",type:"image",gallery:{enabled:!0},retina:{ratio:2},preload:[2,2],removalDelay:500,callbacks:{beforeOpen:function(){var i=this;i.st.image.markup=i.st.image.markup.replace("mfp-figure","mfp-figure mfp-with-anim"),i.st.mainClass=i.st.el.attr("data-effect")}}})})};E(),$("#contact").hover(function(){z.removeClass("icon-speaker-l").addClass("icon-speaker-s")},function(){z.removeClass("icon-speaker-s").addClass("icon-speaker-l")})});